package util;

import java.io.IOException;
import java.sql.*;

import javax.swing.*;

public class Conn {
	// JDBC 
    static final String JDBC_DRIVER = "com.mysql.jdbc.Driver";  
    static final String DB_URL = "jdbc:mysql://localhost:3306/expert?useUnicode=true&characterEncoding=GBK";
    
 // 数据库的用户名密码
    static final String USER = "root";
    static final String PASS = "root";
    
    static Connection conn = null;
	Statement stmt = null;
   
	public Conn(){
		// 注册 JDBC 驱动
        try {
			Class.forName("com.mysql.jdbc.Driver");
		} catch (ClassNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
    
        // 打开链接
        System.out.println("连接数据库...");
        try {
			conn = DriverManager.getConnection(DB_URL,USER,PASS);
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
        
	}
	
	public static ResultSet executeQuery(String sql){
		try{if(conn==null)
			new Conn();
		return conn.createStatement().executeQuery(sql);
		}catch(SQLException e){
			e.printStackTrace();
			return null;	
		}
		finally{}
	}
	
	public static int executeUpdate(String sql){
		try{
			if(conn==null)
				new Conn();
			return conn.createStatement().executeUpdate(sql);
			
		}catch(SQLException e){
			System.out.println(e.getMessage());
			return -1;
		}finally{}
		
	}
		    
		
//     // 执行查询
//        System.out.println(" 实例化Statement对象...");
//        stmt = conn.createStatement();
//        String sql;
//        sql = "SELECT * FROM book";
//        ResultSet rs = stmt.executeQuery(sql);
        
//        while(rs.next()){
//            // 通过字段检索
//        	String usrname  = rs.getString("isbn");
//            String password = rs.getString("title");
//            String address = rs.getString("author");
//
//            // 输出数�?�
//            System.out.print("" + usrname);
//            System.out.print(",: " + password);
//            System.out.print(",  " + address);
//            System.out.print("\n");
//        }
	
}
