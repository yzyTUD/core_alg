package GUI;

import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.GridLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.sql.ResultSet;
import java.sql.SQLException;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.JTextField;
import javax.swing.ListSelectionModel;
import javax.swing.event.ListSelectionEvent;
import javax.swing.event.ListSelectionListener;

import util.Conn;
import DataSer.StringSer;

import com.mysql.jdbc.Connection;

public class LocalBrowser {
	//new
    JFrame jf = new JFrame("显示"); //创建一个窗口
    JPanel jp = new JPanel(); //创建
	JPanel BrotherPanel01 = new JPanel();
	JPanel BrotherPanel02 = new JPanel();
    JScrollPane sp=new JScrollPane();
    JButton jb = new JButton("显示数据");
    //final JLabel jl=new JLabel("0");
    //jp.add(jl);
	public LocalBrowser(){
		//add
	    sp.setPreferredSize(new Dimension(600,200));
	    BrotherPanel01.add(jb);
	
        //logic
        jb.addActionListener(new ActionListener(){
			public void actionPerformed(ActionEvent arg0) {
//				// TODO Auto-generated method stub
//				jl.setText(""+(Integer.parseInt(jl.getText())+1));
				Conn conn=new Conn() ;
				ResultSet rs=Conn.executeQuery("SELECT * FROM expertinfo");
				String []title=StringSer.title;//集中修改
				
				try {
					//to get the count number
					int count=0;
	   	    		while(rs.next()){
	   	    			count++;
	   	    		}
	   	    		Object [][] result=new Object[count][10];
	   	    		count=0;
	   	    		
	   	    		//do it again
	   	    		rs=Conn.executeQuery("SELECT * FROM expertinfo");
					while(rs.next()){
						
						result[count][0] = rs.getString("n1");
						result[count][1] = rs.getString("n2");
						result[count][2] = rs.getString("n3");
						result[count][3] = rs.getString("n4");
						result[count][4] = rs.getString("n5");
						result[count][5] = rs.getString("n6");
						result[count][6] = rs.getString("n7");
						result[count][7] = rs.getString("n8");
						result[count][8] = rs.getString("n9");
						result[count][9] = count+1;
						
						count++;
					}
					final JTable tb=new JTable(result,title);
					ListSelectionModel cellSelectionModel = tb.getSelectionModel();
			        cellSelectionModel.addListSelectionListener(new ListSelectionListener() {
			    		public void valueChanged(ListSelectionEvent e) {
			    			// TODO Auto-generated method stub
			    			if(e.getValueIsAdjusting()){
			    				String selectedData =null;
			    				int selectedRow = tb.getSelectedRow();
			    		        selectedData = (String) tb.getValueAt(selectedRow, 0);
			    		        System.out.println("selectedName: " + selectedData);
			    				new ExpertView(selectedData);
			    			}
			    		}
			        });
					sp.getViewport().add(tb);
				} catch (SQLException e) {
					// TODO Auto-generated catch block
					e.printStackTrace();
				}
			}
        });
        
        
        //set
        jf.setLayout(new BorderLayout());
        jf.add(sp);
        jf.add(BrotherPanel01, BorderLayout.NORTH);
		jf.add(sp);
        jf.setSize(800, 600);
        
        //jf.pack(); //自动调节大小
        //jf.setResizable(false);//不能改变窗口的大小
        jf.setLocation(300,200); // 设置初始的位置
        jf.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);//关闭
        jf.setVisible(true); //解决了初始不可见的问题
		}
	
		public static void main(String[] args) {
			LocalBrowser g=new LocalBrowser();
		}
}